{"./":{"url":"./","title":"前言","keywords":"","body":"逆向利器：IDA 最新版本：v0.6 更新时间：20221023 简介 介绍逆向领域中功能强大且好用的利器：IDA。先介绍IDA概览；再介绍IDA的快速上手过程；再介绍IDA中通用的基础知识，包括界面相关比如布局等、常见命名和含义、自动分析过程、搜索、快捷键；以及介绍IDA各种功能，包括查看代码，比如汇编代码、F5伪代码、函数调用、结构体的类的定义、字符串、函数列表插件等等；再去记录IDA的使用心得；最后整理一些IDA相关的文档和资料，供参考。 源码+浏览+下载 本书的各种源码、在线浏览地址、多种格式文件下载如下： HonKit源码 crifan/reverse_tool_ida: 逆向利器：IDA 如何使用此HonKit源码去生成发布为电子书 详见：crifan/honkit_template: demo how to use crifan honkit template and demo 在线浏览 逆向利器：IDA book.crifan.org 逆向利器：IDA crifan.github.io 离线下载阅读 逆向利器：IDA PDF 逆向利器：IDA ePub 逆向利器：IDA Mobi 版权和用途说明 此电子书教程的全部内容，如无特别说明，均为本人原创。其中部分内容参考自网络，均已备注了出处。如有版权，请通过邮箱联系我 admin 艾特 crifan.com，我会尽快删除。谢谢合作。 各种技术类教程，仅作为学习和研究使用。请勿用于任何非法用途。如有非法用途，均与本人无关。 鸣谢 感谢我的老婆陈雪的包容理解和悉心照料，才使得我crifan有更多精力去专注技术专研和整理归纳出这些电子书和技术教程，特此鸣谢。 更多其他电子书 本人crifan还写了其他100+本电子书教程，感兴趣可移步至： crifan/crifan_ebook_readme: Crifan的电子书的使用说明 crifan.org，使用署名4.0国际(CC BY 4.0)协议发布 all right reserved，powered by Gitbook最后更新： 2022-10-23 23:09:13 "},"ida_overview/":{"url":"ida_overview/","title":"IDA概览","keywords":"","body":"IDA概览 在逆向领域，有款很功能强大且好用的工具=利器是：IDA Pro IDA Pro 常简称：IDA 常用于 iOS逆向 静态分析：逆向二进制，研究代码逻辑 常用功能：函数、F5伪代码、字符等等 动态调试：调试iOS的app crifan.org，使用署名4.0国际(CC BY 4.0)协议发布 all right reserved，powered by Gitbook最后更新： 2022-10-23 20:57:22 "},"ida_quick_start/":{"url":"ida_quick_start/","title":"IDA快手上手","keywords":"","body":"IDA快手上手 iOS逆向 常用：（Mac中）用IDA分析代码 下载和安装IDA 找到要分析的iOS的app的二进制文件 拖动二进制到IDA中 等待分析完毕 利用各种功能，研究代码逻辑 常用功能 字符串 搜索感兴趣的关键字 比如：越狱对应的单词：jailbreak、jail、jb等 函数 搜索已找到的iOS的ObjC的类和函数 用于打开查看代码逻辑 伪代码 当打开函数后，默认是汇编代码，按F5即可打开伪代码 近似于自己写的源码，人类可读的那种，就可以分析代码，搞懂函数的基本（甚至全部的）逻辑了 偶尔用：用IDA调试二进制 下载 IDA官网有试用版可供下载： Download center (hex-rays.com) -> IDA Free IDA Evaluation crifan.org，使用署名4.0国际(CC BY 4.0)协议发布 all right reserved，powered by Gitbook最后更新： 2022-10-23 22:51:26 "},"ida_common/":{"url":"ida_common/","title":"IDA通用知识","keywords":"","body":"IDA通用知识 TODO： 【整理】IDA中一些功能和选项设置 此处整理IDA中的基础的通用的知识。 界面 功能布局 显示相关 名称和命名 自动分析 基本流程 进度 搜索 常用快捷键 crifan.org，使用署名4.0国际(CC BY 4.0)协议发布 all right reserved，powered by Gitbook最后更新： 2022-10-23 22:05:12 "},"ida_common/ui_layout.html":{"url":"ida_common/ui_layout.html","title":"界面布局","keywords":"","body":"界面布局 TODO： 【整理】IDA使用心得：多种显示模式 【已解决】IDA中浮动窗口Output Window如何固定到底部 此处整理，IDA中关于界面显示和布局方面的内容。 导航条=navigator 关于这个： Navigation band=navigator=navbar=导航栏=导航条 有专门的介绍 Igor’s tip of the week #49: Navigation band – Hex Rays (hex-rays.com) 有空可以好好学习看看 crifan.org，使用署名4.0国际(CC BY 4.0)协议发布 all right reserved，powered by Gitbook最后更新： 2022-10-23 22:19:30 "},"ida_common/name_meaning.html":{"url":"ida_common/name_meaning.html","title":"命名和含义","keywords":"","body":"命名和含义 TODO： 【整理】IDA使用心得：常见名称及含义 【未解决】搞懂IDA中_D_objc_selrefs qword_38AF870 % 8的含义 此处整理IDA中，各处看到的，各种名称的命令规则的含义。 命名规则 IDA经常会自动生成假名字。他们用于表示子函数，程序地址和数据。根据不同的类型和值假名字有不同前缀 IDA常见命名意义 sub 指令和子函数起点 locret 返回指令 loc 指令 off 数据，包含偏移量 seg 数据，包含段地址值 asc 数据，ASCII字符串 byte 数据，字节（或字节数组） word 数据，16位数据（或字数组） dword 数据，32位数据（或双字数组） qword 数据，64位数据（或4字数组） flt 浮点数据，32位（或浮点数组） dbl 浮点数，64位（或双精度数组） tbyte 浮点数，80位（或扩展精度浮点数） stru 结构体(或结构体数组) algn 对齐指示 unk 未处理字节 字节相关 db=1个字节 dw=2个字节 dd=4个字节 举例 sub sub_11326A84 unk unk_5922000 qword qword_3A97BE0 具体含义 qword 对于qword： 常常是：常量字符串 偶尔是：其他类型 比如字典的指针等等 详见： 【已解决】IDA中抖音AwemeCore中字符串const char* qword_3893908的原始字符串 【已解决】iOS逆向心得：如何从对x8的adrp和ldr计算出对应的qword字符串值 核心逻辑是： qword_xxx的xxx是二进制内偏移量 + 二进制的ALSR = 实际（字符串的）地址 去查看： [实际（字符串的）地址] = （即可查看到）保存了对应的字符串 【整理】iOS逆向心得：IDA中的unk的含义 crifan.org，使用署名4.0国际(CC BY 4.0)协议发布 all right reserved，powered by Gitbook最后更新： 2022-10-23 22:17:12 "},"ida_common/auto_analysis.html":{"url":"ida_common/auto_analysis.html","title":"自动分析","keywords":"","body":"自动分析 TODO： 【整理】IDA中的自动分析Autoanalysis 【记录】用IDA分析加了符号表的抖音AwemeCore二进制 一般是用IDA去分析二进制中代码的逻辑。而二进制本身其实只有0和1二进制数据而已。 想要分析代码，即查看对应二进制对应的汇编代码（以及后续的伪代码），所包含的函数，所包含的字符串等等信息，则就需要： 对二进制进行充分的分析，最后才能显示出我们要的上述的各种信息。 而对于二进制加载后的分析过程，IDA叫做： 自动分析=auto analysis crifan.org，使用署名4.0国际(CC BY 4.0)协议发布 all right reserved，powered by Gitbook最后更新： 2022-10-23 22:00:38 "},"ida_common/search.html":{"url":"ida_common/search.html","title":"搜索","keywords":"","body":"搜索 TODO： 【整理】IDA使用心得：search搜索查找 IDA中的搜索，可以用于各种地方，包括函数列表，字符串列表，全局搜索，等等。 其中和搜索相关，有些通用的逻辑，此处解释一下。 crifan.org，使用署名4.0国际(CC BY 4.0)协议发布 all right reserved，powered by Gitbook最后更新： 2022-10-23 22:06:14 "},"ida_common/shortcut.html":{"url":"ida_common/shortcut.html","title":"快捷键","keywords":"","body":"快捷键 此处整理IDA的快捷键： IDA_Pro_Shortcuts.pdf (hex-rays.com) 由于：快捷键=Shortcut=cheatsheet 所以此处是：IDA Pro Cheatsheet crifan.org，使用署名4.0国际(CC BY 4.0)协议发布 all right reserved，powered by Gitbook最后更新： 2022-10-23 22:42:02 "},"ida_features/":{"url":"ida_features/","title":"IDA功能详解","keywords":"","body":"IDA功能详解 此处整理IDA中各种强大且好用的功能。 字符串 函数列表 查看代码 汇编代码 伪代码 F5查看伪代码 导出伪代码 函数调用关系 结构体：设置好类的定义，伪代码自动解析出属性调用 插件 keypatch crifan.org，使用署名4.0国际(CC BY 4.0)协议发布 all right reserved，powered by Gitbook最后更新： 2022-10-23 21:10:27 "},"ida_features/view_code/":{"url":"ida_features/view_code/","title":"查看代码","keywords":"","body":"查看代码 一般主要用IDA来查看和分析代码，代码主要分： 汇编代码：从原始二进制的字节码，反汇编得到的汇编代码 伪代码：从汇编代码用F5反编译得到的，很接近人类写的代码，人类能读懂代码逻辑的代码 crifan.org，使用署名4.0国际(CC BY 4.0)协议发布 all right reserved，powered by Gitbook最后更新： 2022-10-23 21:16:18 "},"ida_features/view_code/asm_code.html":{"url":"ida_features/view_code/asm_code.html","title":"汇编代码","keywords":"","body":"汇编代码 TODO： 【已解决】IDA使用心得：IDA汇编代码如何快速找到匹配的Xcode汇编代码 【已解决】IDA中查看ARM汇编的伪代码 【未解决】IDA中开启宏指令比如ADRP和ADD变成ADRL 【整理】IDA使用心得：auto comments 【整理】IDA使用心得：OpCode区 IDA中的汇编代码，是从原始二进制的字节码，反汇编得到的汇编代码 一般来说，在逆向尝试搞懂代码逻辑时，不太需要直接查看汇编代码，因为的确很难直接看懂逻辑。 不过有些情况下，会用到汇编代码： iOS逆向 静态分析 有些汇编代码中，IDA已帮忙分析和插入了相关的解释信息，值得研究逻辑时去参考 比如，YouTube逆向期间，IDA已帮忙给相关汇编加上了描述，指明了有些代码是vtable的部分 便于分析和对照，寻找对应虚函数的具体实现 动态调试 想要找到调试期间的，Xcode中汇编代码，对应的代码逻辑 往往就需要找到IDA中对应的伪代码是什么 往往就需要先去找到IDA中汇编代码的位置 再去F5（或Tab键）跳转到对应的伪代码的位置 crifan.org，使用署名4.0国际(CC BY 4.0)协议发布 all right reserved，powered by Gitbook最后更新： 2022-10-23 22:03:48 "},"ida_features/view_code/pseudocode.html":{"url":"ida_features/view_code/pseudocode.html","title":"伪代码","keywords":"","body":"伪代码 TODO： 【未解决】IDA使用心得：伪代码内新增变量 【整理】IDA使用心得：刷新当前已打开的伪代码用F5 【整理】IDA使用心得：伪代码中的指针+某个数值和0x开头LL结尾的数值不是一个意思 【整理】IDA使用心得：给伪代码添加注释 【整理】IDA使用心得：伪代码中的可变参数个数的函数去增加或删除参数 【整理】iOS逆向心得：IDA使用心得：改变值的显示格式从10进制改为16进制查看Block的flags标志位 【整理】iOS逆向心得：IDA Pro使用心得：给函数改名便于快速定位汇编伪代码对应关系 【iOS逆向心得】IDA使用心得：伪代码中在修改了别处函数定义后返回导致伪代码中函数调用参数丢失 【整理】IDA使用心得：反编译伪代码常见错误 Failures and troubleshooting (hex-rays.com) 【整理】IDA使用心得：如何理解反汇编后的伪代码的逻辑 【记录】IDA使用心得：objc_msgSend跳板函数重命名优化 【记录】IDA使用心得：伪代码改名重命名改回默认值 【记录】IDA使用心得：给伪代码的变量改名 【已解决】IDA使用心得：伪代码中如何找到对应的IDA汇编代码 【已解决】IDA中给汇编代码或伪代码改名 【整理】IDA使用心得：改名 给变量改类型 【整理】IDA使用心得：F5伪代码 代码逆向相关： 【已解决】IDA中xsp和xbp是什么意思如何定位地址 【整理】IDA使用心得：IDA伪代码和汇编代码 反汇编 逻辑关系 理解 IDA中，支持从汇编代码，按F5快捷键去反编译得到的伪代码 -> 很接近人类写的代码，人类能容易读懂代码逻辑的代码 IDA中最强的功能，应该就属这个伪代码了。 IDA反编译出的伪代码： 质量很高：很接近原程序的代码的逻辑 且有很多额外好用的功能支持 比如 重命名：rename 变量更改类型：change type 增加减少参数个数 自动解析出类的属性的引用 等等 伪代码中，右键，支持很多功能： Rename Set type Set number representation Edit indented comment Edit block comment Hide/unhide statements Split/unsplit expression Force call type Set call type Add/del variadic arguments Del function argument Add/delete function return type Jump to cross reference Jump to cross reference globally Generate HTML file Mark/unmark as decompiled Copy to assembly Show/hide casts 而根据当前元素类型，（可能）会显示额外菜单=功能=选项： 局部变量 Reset pointer type Convert to struct * Create new struct type Map to another variable Unmap variable(s) Force new variable 联合体union Select union field 括号类：圆括号、中括号、花括号 Jump to paired paren 文本 Copy快捷键：Ctrl+C C表达式关键字 Collapse/uncollapse item 具体细节详见： Interactive operation (hex-rays.com) crifan.org，使用署名4.0国际(CC BY 4.0)协议发布 all right reserved，powered by Gitbook最后更新： 2022-10-23 22:32:31 "},"ida_features/view_code/function_call.html":{"url":"ida_features/view_code/function_call.html","title":"函数调用","keywords":"","body":"函数调用 TODO： 【整理】iOS逆向心得：IDA中以列表形式列出函数被调用的地方 【整理】iOS逆向心得之IDA使用心得：查看函数被调用的所有的地方即被调用函数的列表 【整理】iOS逆向心得之IDA使用心得：如何快速找到真正的函数的被调用的列表函数名 【整理】IDA 使用心得：交叉引用以列表方式显示 IDA中代码分析方面，对于函数的调用的关系，也有很好的支持。 iOS逆向期间，往往涉及到，想要搞懂一个函数，被其他哪些地方调用到了等等，和函数调用关系相关的内容。IDA对此支持的都很好。 Xrefs to=有哪些地方引用到了此函数 显示界面的底层实现所用的库 IDA中函数调用的graph，通过ida64的quit，看到的是：qwingraph 而qwingraph，其实是一个插件，底层可视化插件 可以从 Download center (hex-rays.com) 找到： Qwingraph v1.10 Source code the Wingraph we use and modified (GPL) https://hex-rays.com/products/ida/support/freefiles/qwingraph_src.zip 而WinGraph32本身的关于的信息是： WinGraph32 Copyright (c) 2015 Hex-Rays Version 1.10 This program is based on VCG library written by Georg Sander and Iris Lemke WinGraph32 is released under GPL (GNU General Public License) https://www.hex-rays.com crifan.org，使用署名4.0国际(CC BY 4.0)协议发布 all right reserved，powered by Gitbook最后更新： 2022-10-23 22:49:25 "},"ida_features/view_code/struct_class_def.html":{"url":"ida_features/view_code/struct_class_def.html","title":"结构体类定义","keywords":"","body":"结构体定义 TODO： 新增Structure结构体定义 + 且双击后，可以导入到数据库中 【已解决】IDA中如何给Local Types中struct MLServerABRLoader加上嵌入的struct结构体定义 【整理】iOS逆向心得：IDA使用心得：修改变量类型Set Ivar Type后IDA可以自动解析结构体的属性和字段 【整理】IDA使用心得：类的部分字段无法解析，导致伪代码中类的属性错误，需要手动修复结构体定义 IDA中，支持把类的原始定义，通过结构体的形式写出来（甚至自动分析出来对应结构体定义），从而后续的汇编代码和伪代码中，自动解析出类的属性和函数的调用，很是方便。 且也支持新增自定义的结构体，更改已有类的结构体的字段定义等，很强大好用的功能。 创建结构体 crifan.org，使用署名4.0国际(CC BY 4.0)协议发布 all right reserved，powered by Gitbook最后更新： 2022-10-23 22:26:21 "},"ida_features/strings.html":{"url":"ida_features/strings.html","title":"字符串","keywords":"","body":"字符串 IDA也能自动分析出，二进制中有哪些字符串，放到一个单独视图Strings，供分析和研究。 crifan.org，使用署名4.0国际(CC BY 4.0)协议发布 all right reserved，powered by Gitbook最后更新： 2022-10-23 21:28:08 "},"ida_features/function_list.html":{"url":"ida_features/function_list.html","title":"函数列表","keywords":"","body":"函数列表 IDA可以分析出，二进制中的所有的函数，并且列出函数的列表，供查找和定位，以及后续代码逻辑的研究。 crifan.org，使用署名4.0国际(CC BY 4.0)协议发布 all right reserved，powered by Gitbook最后更新： 2022-10-23 21:28:47 "},"ida_features/plugins.html":{"url":"ida_features/plugins.html","title":"插件","keywords":"","body":"插件 IDA还支持插件的机制，可以扩展支持更多更强的各种功能。 常见的插件有： keypatch crifan.org，使用署名4.0国际(CC BY 4.0)协议发布 all right reserved，powered by Gitbook最后更新： 2022-10-23 21:30:17 "},"ida_usage_note/":{"url":"ida_usage_note/","title":"IDA使用心得","keywords":"","body":"IDA使用心得 TODO： 【记录】IDA Pro使用记录 使用IDA逆向分析和调试期间，有很多心得，整理如下，供参考。 界面布局 【整理】IDA使用心得：把类结构Structures的窗口放在右边方便对比查看 代码分析 函数跳转 Jump跳转 【整理】IDA使用心得：根据selector跳转到函数 【整理】IDA使用心得：跳转到历史列表的函数位置 函数 【整理】IDA使用心得：通过给函数Set Item Type去修正函数的参数的个数和类型和返回值类型 类 【整理】IDA心得：自定义的类的属性偏移量和自动生成的偏移量不匹配 bug 【整理】IDA使用心得：iOS的ObjC伪代码反编译翻译的有错误不够准确 如何处理数组Array Working with array crifan.org，使用署名4.0国际(CC BY 4.0)协议发布 all right reserved，powered by Gitbook最后更新： 2022-10-23 22:25:07 "},"appendix/":{"url":"appendix/","title":"附录","keywords":"","body":"附录 下面列出相关参考资料。 crifan.org，使用署名4.0国际(CC BY 4.0)协议发布 all right reserved，powered by Gitbook最后更新： 2022-03-17 20:39:28 "},"appendix/doc_refer.html":{"url":"appendix/doc_refer.html","title":"文档和资料","keywords":"","body":"文档和资料 TODO： 【整理】学习IDA教程：The IDA Pro Book 此处整理IDA相关的文档、教程、书籍等有价值的参考资料。 IDA的tip of week tip of week index (hex-rays.com) 有很多有用提示 有空可以看看 IDA官网的下载中心 IDA官网的下载中心： Download center (hex-rays.com) 有很多相关内容，可供学习和使用： SDK and Utilities Some downloads are only available to IDA Pro users and require a password which can be found in the latest download email. IDA SDK 7.7 Develop processor modules, loaders and extensions - extended with the source of 30+ modules and 20+ loaders. Please check out the SDK documentation online (or download the zip file for offline use). Flair 7.7 Add your own compiler libraries to the FLIRT engine IDAClang 7.7 A type library generator based on libclang. Use this when parsing complex C++ code that tilib cannot handle. Tilib 7.7 Create your own type libraries Loadint 7.7 Create your own disassembler comment databases idsutils 7.7 Create your own IDS files from DLLs ios_deploy iOS helper utility to manipulate iOS devices PIN tool The source code of our PIN tool. It creates a debugger backend out of Intel's PIN framework See: PIN framework TVision 2015 library For the IDA text interface (source code) Qwingraph v1.10 Source code the Wingraph we use and modified (GPL) Sample plugins Stealth Stealth against anti-debugging tricks findcrypt Identifies some frequently used block ciphers highlighter Highlights code that has been single stepped through in a debugging session unispector Extracts unicode strings from an IDA database IDA Pro, Python and Qt Migrating PySide code to PyQt5 Using custom viewers from IDAPython Augmenting IDA UI with your own actions Plugin contest pages Our plugins contest pages offer many useful plugins! By year: 2009, 2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019 User contributions Plugins COM Interface Plugin By Dieter Spaar Sobek A simple data-flow analysis plugin by JF Michel PDBPlus By Dean Ashton IDB_2_PAT By J.C Roberts strucrec By Halvar Flake Class Informer plugin To reconstruct C++ classes using the RTTI info By Sirmabus IDC scripts Visual Basic Disassembly IDC script To assist in the disassembly of VB5/VB6 hostile code By Reginald Wong IDC Delphi script Delphi constants and class definitions By Dietrich Teickner h2enum converts C/C++ header files to IDA enums - Nice if you have no TIL files By Leonid Lisovsky IDC PDR script Useful in the analysis of PDR files (port drivers) By Huang Yu Loader script For VC++ and Borland C++ By Toshiyuki Tega Microchipss 16F84 PIC script Defines SFR and bit names for Microchip's 16F84 PIC processor but can be used as a template for other processors By an anonymous contributor dumpinfo By JC Roberts Pentica-B script Pentica-B import script for the H8-8300 By Tom Hayes H8 script Improves the inital H8 autoanalysis By Tom Hayes Processor modules AMD 29K processor module By Arne Wichmann NEC V830 processor module By Ben Byer Samsung SAM8 By Andrew de Quincey. Also available is a plugin that generates files compatible with the SAMA assembler. Miscellaneous symload By Dainis Jonitis PE utilities A set of extremely useful PE utilities By Atli Mar Gudmundsson H8 utilities A few utilities that could be useful to H8 developers By Tom Hayes 抽空可以好好找找看看，有哪些值得好好利用的东西。 BH_Eagle_ida_pro.pdf 无意间看到的别人整理的IDA的内容： BH_Eagle_ida_pro.pdf 下载到此处 BH_Eagle_ida_pro.pdf 供下载和学习。 crifan.org，使用署名4.0国际(CC BY 4.0)协议发布 all right reserved，powered by Gitbook最后更新： 2022-10-23 23:01:22 "},"appendix/reference.html":{"url":"appendix/reference.html","title":"参考资料","keywords":"","body":"参考资料 Failures and troubleshooting (hex-rays.com) Igor’s tip of the week #49: Navigation band – Hex Rays (hex-rays.com) tip of week index (hex-rays.com) Interactive operation (hex-rays.com) IDA_Pro_Shortcuts.pdf (hex-rays.com) Download center (hex-rays.com) IDA Free IDA Evaluation BH_Eagle_ida_pro.pdf crifan.org，使用署名4.0国际(CC BY 4.0)协议发布 all right reserved，powered by Gitbook最后更新： 2022-10-23 22:58:25 "}}